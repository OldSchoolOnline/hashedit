var hashedit=hashedit||{};hashedit=function(){"use strict";return{version:"0.5.8",url:null,saveUrl:"/api/pages/save",addPageURL:"/api/pages/add",pageSettingsURL:"/api/pages/settings",uploadUrl:"/api/images/add",imagesListUrl:"/api/images/list",pagesListUrl:"/api/pages/list",authUrl:"/api/auth",loginUrl:"/login",pathListUrl:"/api/pages/path/list",imagesListLoaded:!1,pagesListLoaded:!1,pathListLoaded:!1,debug:!0,demo:!1,path:"/node_modules/hashedit/",stylesheet:["/node_modules/hashedit/dist/hashedit-min.css"],current:{container:null,node:null,parent:null,element:null,image:null},selection:null,elementMenu:'<span class="hashedit-move"><span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" fit="" style="pointer-events: none; display: block;"><g><path d="M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"></path></g></svg></span></span><span class="hashedit-properties"><span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet"><g><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></g></svg></span></span><span class="hashedit-remove"><span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet"><g><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></g></svg></span></span><span class="hashedit-edit"><span><svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"><g><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g></svg></span></span>',framework:"bootstrap",frameworkDefaults:{bootstrap:{table:"table",image:"img-responsive",code:""},foundation:{table:"",image:"",code:""},foundation:{table:"mdl-data-table",image:"",code:""}},menu:[{action:"hashedit.h1",selector:"h1",title:"H1 Headline",display:"H1",html:"<h1>Start Typing...</h1>"},{action:"hashedit.h2",selector:"h2",title:"H2 Headline",display:"H2",html:"<h2>Start Typing...</h2>"},{action:"hashedit.h3",selector:"h3",title:"H3 Headline",display:"H3",html:"<h3>Start Typing...</h3>"},{action:"hashedit.h4",selector:"h4",title:"H4 Headline",display:"H4",html:"<h4>Start Typing...</h4>"},{action:"hashedit.h5",selector:"h5",title:"H5 Headline",display:"H5",html:"<h5>Start Typing...</h5>"},{action:"hashedit.p",selector:"p",title:"Paragraph",display:"P",html:"<p>Start Typing...</p>"},{action:"hashedit.blockquote",selector:"blockquote",title:"Blockquote",display:"<svg viewBox='0 0 24 24' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><g><path d='M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z'></path></g></svg>",html:"<blockquote></blockquote>"},{action:"hashedit.ul",selector:"ul",title:"Unordered List",display:"<svg viewBox='0 0 24 24' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><g><path d='M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12.17c-.74 0-1.33.6-1.33 1.33s.6 1.33 1.33 1.33 1.33-.6 1.33-1.33-.59-1.33-1.33-1.33zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z'></path></g></svg>",html:"<ul><li></li></ul>"},{action:"hashedit.ol",selector:"ol",title:"Ordered List",display:"<svg viewBox='0 0 24 24' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><g><path d='M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z'></path></g></svg>",html:"<ol><li></li></ol>"},{action:"hashedit.image",selector:"img",title:"Image",display:"<svg viewBox='0 0 24 24' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><path d='M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z'></path></g></svg>",html:'<img src="{{path}}images/placeholder.png" class="{{framework.image}}">',configure:function(){hashedit.showImageDialog()}},{action:"hashedit.table",selector:"table",title:"Table",display:"<svg viewBox='0 0 24 24' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><g><path d='M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z'></path></g></svg>",html:'<table class="{{framework.table}}" rows="1" columns="2"><thead><tr><th>Header</th><th>Header</th></tr></thead><tbody><tr><td>Content</td><td>Content</td></tr></tbody></table>',attributes:[{attr:"rows",label:"Rows",type:"select",values:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]},{attr:"columns",label:"Columns",type:"select",values:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]}],change:function(e,t,a){var i,n,r,h,s,d,l,o,u,c,m,p,g,v;if(t!=a)if("columns"==e){if(s=t,d=a,s>d)for(l=s-d,u=hashedit.current.node,c=hashedit.current.node.getElementsByTagName("tr"),i=0;i<c.length;i+=1)for(n=0;l>n;n+=1)"THEAD"==c[i].parentNode.nodeName?(m=document.createElement("th"),m.setAttribute("contentEditable","true"),m.innerHTML="New Header",c[i].appendChild(m)):(g=document.createElement("td"),g.setAttribute("contentEditable","true"),g.innerHTML="Content",c[i].appendChild(g));else if(d>s)for(o=d-s,u=hashedit.current.node,c=hashedit.current.node.getElementsByTagName("tr"),i=0;i<c.length;i+=1)for(n=0;o>n;n+=1)"THEAD"==c[i].parentNode.nodeName?c[i].querySelector("th:last-child").remove():c[i].querySelector("td:last-child").remove()}else if("rows"==e)if(r=t,h=a,u=hashedit.current.node,s=u.querySelectorAll("thead tr:first-child th").length,console.log("rows, new="+r+", old="+h+", columns="+s),r>h)for(l=r-h,n=0;l>n;n+=1){for(p=document.createElement("tr"),i=0;s>i;i+=1)g=document.createElement("td"),g.setAttribute("contentEditable","true"),g.innerHTML="Content",p.appendChild(g);v=u.getElementsByTagName("tbody")[0],v.appendChild(p)}else if(h>r)for(o=h-r,n=0;o>n;n+=1)p=u.querySelector("tbody tr:last-child"),null!==p&&p.remove()}},{action:"hashedit.code",selector:"pre",title:"Code",display:"<svg viewBox='0 0 24 24'  height='100%' width='100%' preserveAspectRatio='xMidYMid meet' style='pointer-events: none; display: block;'><g><path d='M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z'></path></g></svg>",html:"<pre>Start adding code</pre>"}],mirror:null,newElementCount:0,setActive:function(){document.querySelector("body").setAttribute("hashedit-active","")},setContentEditable:function(){var e,t;for(t=document.querySelectorAll(".hashedit-element>p, [hashedit] .hashedit-element>h1, [hashedit] .hashedit-element>h2, .hashedit-element>h3, .hashedit-element>h4, .hashedit-element>h5, .hashedit-element>ul li, .hashedit-element>ol li, .hashedit-element>table td, .hashedit-element>table th, .hashedit-element>blockquote, .hashedit-element>pre"),e=0;e<t.length;e+=1)t[e].setAttribute("contentEditable","true")},setupSortable:function(e){var t,a,i,n,r,h,s,d,l,o,u;for(t=0;t<e.length;t+=1)for(i=document.querySelectorAll("[hashedit] "+e[t]),a=0;a<i.length;a+=1)i[a].setAttribute("hashedit-sortable","");for(i=document.querySelectorAll("[hashedit-sortable] > *"),a=0;a<i.length;a+=1)n=document.createElement("div"),n.setAttribute("class","hashedit-element"),hashedit.wrap(n,i[a]),r=document.createElement("span"),r.setAttribute("class","hashedit-move"),r.innerHTML='<span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" fit="" style="pointer-events: none; display: block;"><g><path d="M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"></path></g></svg></span>',n.appendChild(r),r=document.createElement("span"),r.setAttribute("class","hashedit-properties"),r.innerHTML='<span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet"><g><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></g></svg></span>',n.appendChild(r),r=document.createElement("span"),r.setAttribute("class","hashedit-remove"),r.innerHTML='<span><svg viewBox="0 0 24 24" height="100%" width="100%" preserveAspectRatio="xMidYMid meet"><g><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></g></svg></span>',n.appendChild(r),r=document.createElement("span"),r.setAttribute("class","hashedit-edit"),r.innerHTML='<span><svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"><g><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g></svg></span>',n.appendChild(r);for(i=document.querySelectorAll("[hashedit] [hashedit-sortable]"),t=0;t<i.length;t+=1)h=i[t],u=new Sortable(h,{group:"hashedit-sortable",sort:!0,delay:0,disabled:!1,store:null,animation:150,handle:".hashedit-move",ghostClass:"hashedit-highlight",scroll:!0,scrollSensitivity:30,scrollSpeed:10,onEnd:function(e){s=e.item,d=s.querySelector(":first-child").getAttribute("data-ref"),void 0!==d&&(s.nextSibling?s.nextSibling.querySelector&&(l=s.nextSibling.querySelector(":first-child").getAttribute("data-ref"),hashedit.moveMirrorElement(d,l,"before")):s.parentNode&&(o=s.parentNode.getAttribute("data-ref"),hashedit.moveMirrorElement(d,o,"append")))}})},setupMenu:function(){var e,t,a;e=document.createElement("menu"),e.setAttribute("class","hashedit-menu"),e.innerHTML='<button class="hashedit-back"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button><button class="hashedit-save"><svg height="24" width="24" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"><g><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"></path></g></svg></button><div class="hashedit-menu-body"></div>',hashedit.current.container.appendChild(e),document.querySelector(".hashedit-back").addEventListener("click",function(){history.go(-1)}),document.querySelector(".hashedit-save").addEventListener("click",function(){hashedit.demo===!0?hashedit.showToast("Cannot save in demo mode","failure"):(t=hashedit.retrieveUpdateArray(),hashedit.saveUrl&&(a=new XMLHttpRequest,a.open("post",hashedit.saveUrl,!0),1==hashedit.useToken&&a.setRequestHeader(hashedit.authHeader,hashedit.authHeaderPrefix+" "+localStorage.getItem(hashedit.tokenName)),a.send(JSON.stringify(t)),a.onloadend=function(){hashedit.showToast("Updates saved!","success")}))})},setupDraggable:function(){var e,t,a,i,n,r;t=document.querySelector(".hashedit-menu-body"),a=new Sortable(t,{group:{name:"hashedit-sortable",pull:"clone",put:!1},draggable:"a",sort:!1,delay:0,disabled:!1,animation:150,ghostClass:"hashedit-highlight",scroll:!0,scrollSensitivity:30,scrollSpeed:10,onEnd:function(t){for(i=t.item,n=i.getAttribute("data-action"),e=0;e<hashedit.menu.length;e+=1)hashedit.menu[e].action==n&&(r=hashedit.menu[e].html,r=hashedit.replaceAll(r,"{{path}}",hashedit.path),r=hashedit.replaceAll(r,"{{framework.image}}",hashedit.frameworkDefaults[hashedit.framework].image),r=hashedit.replaceAll(r,"{{framework.table}}",hashedit.frameworkDefaults[hashedit.framework].table),r=hashedit.replaceAll(r,"{{framework.code}}",hashedit.frameworkDefaults[hashedit.framework].code),hashedit.append(r));return!1}})},loadHTML:function(e){var t,a;fetch(e+"html/modals.html").then(function(e){return e.text()}).then(function(e){for(a=document.createElement("div"),a.innerHTML=e,t=0;t<a.childNodes.length;t+=1)hashedit.current.container.appendChild(a.childNodes[t]);for(t=0;t<hashedit.menu.length;t+=1)hashedit.menu[t].init&&hashedit.menu[t].init();hashedit.setupConfigEvents(),hashedit.setupTextEvents(),hashedit.setupModalEvents()})},createMenu:function(){var e,t,a;for(e=0;e<hashedit.menu.length;e+=1)t=hashedit.menu[e],a=document.createElement("a"),a.setAttribute("title",t.title),a.setAttribute("data-action",t.action),a.innerHTML=t.display,document.querySelector(".hashedit-menu-body").appendChild(a);hashedit.setupDraggable()},showTextOptions:function(e){var t,a,i,n,r;for(hashedit.current.element=e,hashedit.current.parent=hashedit.findParentBySelector(e,".hashedit-element"),hashedit.current.node=hashedit.current.parent.firstChild,i=document.querySelector("#hashedit-image-settings-modal"),i.removeAttribute("visible"),a=document.querySelector("#hashedit-link-settings-modal"),a.removeAttribute("visible"),n=document.querySelector("#hashedit-text-settings"),n.setAttribute("visible",""),r=document.querySelectorAll("[data-model]"),t=0;t<r.length;t+=1)"SELECT"==r[t].nodeType?r[t].selectedIndex=0:r[t].value="";hashedit.bind()},bind:function(){var e,t,a,i,n,r;for(e=hashedit.current.node.attributes,t=0;t<e.length;t+=1)for(i=e[t].nodeName.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}),n=e[t].nodeValue,!isNaN(parseFloat(n))&&isFinite(n)&&(n=parseFloat(n)),r=document.querySelectorAll('[data-model="node.'+i+'"]'),a=0;a<r.length;a+=1)r[a].value=n},setupContentEditableEvents:function(){var e,t,a,i,n,r,h,s,d,l,o,u,c,m,p,g,v,f,b,A,y,E,M,w,S,x,m;for(i=document.querySelectorAll("body"),e=0;e<i.length;e+=1)["click","focus"].forEach(function(d){i[e].addEventListener(d,function(i){for(c=hashedit.findParentBySelector(i.target,".hashedit-element"),f=null,null!==c&&(f=c.firstChild),m=document.querySelectorAll("[current-hashedit-element]"),t=0;t<m.length;t+=1)m[t].removeAttribute("current-hashedit-element");if(c&&c.setAttribute("current-hashedit-element","true"),p=!1,null!==hashedit.findParentBySelector(i.target,".hashedit-properties")&&(p=!0),v=!1,null!==hashedit.findParentBySelector(i.target,".hashedit-remove")&&(v=!0),v===!0){c.remove();var d=f.getAttribute("data-ref");null!==d&&hashedit.removeMirrorElement(d)}else if(p===!0){for(hashedit.current.node=f,g=!0,x=null,e=0;e<hashedit.menu.length;e+=1)c.firstChild.matches(hashedit.menu[e].selector)&&(x=hashedit.menu[e],hashedit.menu[e].configure&&(g=!1,hashedit.menu[e].configure()));if(g===!0){for(b=document.getElementById("hashedit-element-settings-modal"),A=b.querySelector(".hashedit-modal-body"),m=A.querySelectorAll(".hashedit-custom-attr"),t=0;t<m.length;t++)m[t].parentNode.removeChild(m[t]);if(null!=x&&x.attributes)for(t=0;t<x.attributes.length;t++){if(y=x.attributes[t],E=document.createElement("div"),E.setAttribute("class","hashedit-custom-attr"),M=document.createElement("label"),M.innerHTML=y.label,E.appendChild(M),"text"==y.type&&(w=document.createElement("input"),w.setAttribute("type","text"),w.setAttribute("data-model","node."+y.attr),w.setAttribute("name","attr"),E.appendChild(w)),"select"==y.type){if(w=document.createElement("select"),w.setAttribute("data-model","node."+y.attr),w.setAttribute("name","attr"),null!=y.values)for(a=0;a<y.values.length;a++)S=document.createElement("option"),y.values[a].text?(S.setAttribute("value",y.values[a].value),S.innerHTML=y.values[a].text):(S.setAttribute("value",y.values[a]),S.innerHTML=y.values[a]),w.appendChild(S);E.appendChild(w)}A.appendChild(E)}hashedit.bind(),b.setAttribute("visible","true")}}else if("A"==i.target.nodeName){for(n=document.querySelectorAll("[hashedit]"),r=!1,e=0;e<n.length;e+=1)n[e].contains(i.target)===!0&&(r=!0);r&&hashedit.showLinkDialog()}else if("IMG"==i.target.nodeName){for(hashedit.current.node=i.target,n=document.querySelectorAll("[hashedit]"),r=!1,e=0;e<n.length;e+=1)n[e].contains(i.target)===!0&&(r=!0);r&&hashedit.showImageDialog()}else if(i.target.hasAttribute("contentEditable"))hashedit.showTextOptions(i.target);else if(i.target.parentNode.hasAttribute("contentEditable")&&i.target.parentNode)hashedit.showTextOptions(i.target);else if("dz-hidden-input"==i.target.className);else{for(h=document.querySelectorAll(".hashedit-config, .hashedit-modal, .hashedit-menu"),s=!1,e=0;e<h.length;e+=1)h[e].contains(i.target)===!0&&(s=!0);if(s===!1)for(e=0;e<h.length;e+=1)h[e].removeAttribute("visible")}})}),["input"].forEach(function(t){i[e].addEventListener(t,function(e){if(e.target.hasAttribute("contentEditable"))for(d=e.target;null!==d;)d.hasAttribute("data-ref")?(l=d.getAttribute("data-ref"),o=d.innerHTML,hashedit.setMirrorHTML(l,o),d=null):d=d.parentNode})}),["keydown"].forEach(function(t){i[e].addEventListener(t,function(e){e.target.hasAttribute("contentEditable")&&(d=e.target,13===e.keyCode&&"LI"==d.nodeName&&(u=document.createElement("li"),u.setAttribute("contentEditable",!0),d.parentNode.appendChild(u),d.parentNode.lastChild.focus(),e.preventDefault(),e.stopPropagation()),8===e.keyCode&&"LI"==d.nodeName&&""===d.innerHTML&&(console.log(d.previousSibling),null!==d.previousSibling&&(c=d.parentNode,d.remove(),c.lastChild.focus()),e.preventDefault(),e.stopPropagation()))})})},selectElementContents:function(e){var t,a;t=document.createRange(),t.selectNodeContents(e),a=window.getSelection(),a.removeAllRanges(),a.addRange(t)},append:function(e){var t,a,i,n,r,h,s;if(a=document.createElement("div"),a.setAttribute("class","hashedit-element"),a.innerHTML=e+hashedit.elementMenu,i=document.querySelector("[hashedit-sortable] [data-action]"),null!==i){i.parentNode.replaceChild(a,i);var d=a.querySelectorAll("p, h1, h2, h3, h4, h5, li, td, th, blockquote, pre");for(t=0;t<d.length;t+=1)d[t].setAttribute("contentEditable","true");d.length>0&&(d[0].focus(),hashedit.showTextOptions(d[0]),hashedit.selectElementContents(d[0])),hashedit.newElementCount=hashedit.newElementCount+1,n=a.querySelector(":first-child"),null!==n&&(r="new-"+hashedit.newElementCount,n.setAttribute("data-ref",r)),a.nextSibling?(h=a.nextSibling.querySelector(":first-child").getAttribute("data-ref"),hashedit.insertMirrorElement(r,h,"before",e)):a.parentNode&&(s=a.parentNode.getAttribute("data-ref"),hashedit.insertMirrorElement(r,s,"append",e))}return a},setupModalEvents:function(){var e,t,a,i,n,r,h,s,d;if(void 0!=Dropzone&&null!=Dropzone){var d={url:hashedit.uploadUrl};1==hashedit.useToken&&(d.headers={},d.headers[hashedit.authHeader]=hashedit.authHeaderPrefix+" "+localStorage.getItem(hashedit.tokenName)),t=new Dropzone("#hashedit-dropzone",d),t.on("complete",function(e){t.removeFile(e)}),t.on("success",function(e,t){var a="files/"+e.name;s=document.getElementById("hashedit-image-src"),s.value=a,n=document.getElementById("images-list"),r=document.createElement("div"),r.setAttribute("class","hashedit-list-item"),r.innerHTML="images/"+a,r.setAttribute("data-value","images/"+a),n.appendChild(r),s.dispatchEvent(new Event("input",{bubbles:!0})),i=document.getElementById("hashedit-image-settings-modal"),i.removeAttribute("hashedit-card-flipped")})}for(n=document.getElementById("images-list"),["click"].forEach(function(e){n.addEventListener(e,function(e){e.target.hasAttribute("data-value")===!0&&(h=e.target.getAttribute("data-value"),s=document.getElementById("hashedit-image-src"),s.value=h,s.dispatchEvent(new Event("input",{bubbles:!0})),i=document.getElementById("hashedit-image-settings-modal"),i.removeAttribute("hashedit-card-flipped"))})}),n=document.getElementById("pages-list"),["click"].forEach(function(e){n.addEventListener(e,function(e){e.target.hasAttribute("data-value")===!0&&(h=e.target.getAttribute("data-value"),s=document.getElementById("hashedit-link-href"),s.value=h,s.dispatchEvent(new Event("input",{bubbles:!0})),i=document.getElementById("hashedit-link-settings-modal"),i.removeAttribute("hashedit-card-flipped"))})}),a=document.querySelectorAll(".toggle-select-image"),e=0;e<a.length;e+=1)["click"].forEach(function(t){a[e].addEventListener(t,function(t){i=document.querySelector("#hashedit-image-settings-modal"),i.hasAttribute("hashedit-card-flipped")?i.removeAttribute("hashedit-card-flipped"):i.setAttribute("hashedit-card-flipped","true"),hashedit.imagesListLoaded===!1&&fetch(hashedit.imagesListUrl,{credentials:"include"}).then(function(e){return e.json()}).then(function(t){for(n=document.getElementById("images-list"),n.innerHTML="",e=0;e<t.length;e+=1)r=document.createElement("div"),r.setAttribute("class","hashedit-list-item"),r.innerHTML=t[e],r.setAttribute("data-value",t[e]),n.appendChild(r);hashedit.imagesListLoaded=!0})["catch"](function(e){console.log("parsing failed",e)})})});for(a=document.querySelectorAll(".toggle-select-url"),e=0;e<a.length;e+=1)["click"].forEach(function(t){a[e].addEventListener(t,function(t){if(i=document.querySelector("#hashedit-link-settings-modal"),i.hasAttribute("hashedit-card-flipped")?i.removeAttribute("hashedit-card-flipped"):i.setAttribute("hashedit-card-flipped","true"),hashedit.pagesListLoaded===!1){var a={credentials:"include"};hashedit.useToken&&(a={headers:{}},a.headers[hashedit.authHeader]=hashedit.authHeaderPrefix+" "+localStorage.getItem(hashedit.tokenName)),fetch(hashedit.pagesListUrl,a).then(function(e){return e.json()}).then(function(t){for(n=document.getElementById("pages-list"),n.innerHTML="",e=0;e<t.length;e+=1)r=document.createElement("div"),r.setAttribute("class","hashedit-list-item"),r.innerHTML=t[e].Url,r.setAttribute("data-value",t[e].Url),n.appendChild(r);hashedit.pagesListLoaded=!0})["catch"](function(e){console.log("parsing failed",e)})}})})},setupConfigEvents:function(){var e,t,a,i,n,r,h,s,d,l;for(t=document.querySelectorAll(".hashedit-config, .hashedit-modal"),e=0;e<t.length;e+=1)["propertychange","change","click","keyup","input","paste"].forEach(function(o){t[e].addEventListener(o,function(t){if(a=t.target,a.hasAttribute("hashedit-cancel-modal"))for(i=document.querySelectorAll(".hashedit-modal"),e=0;e<i.length;e+=1)i[e].removeAttribute("visible");if(a.hasAttribute("data-model")){if(null!==hashedit.current.node&&(n=hashedit.current.node.getAttribute("data-ref")),r=a.getAttribute("data-model"),h="",s="",h=a.value,-1!=r.indexOf("node.")&&(d=r.split("."),d.length>1)){s=d[1].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var o=hashedit.current.node.getAttribute(s);for(hashedit.current.node.setAttribute(s,h),hashedit.setMirrorAttribute(n,s,h),l=hashedit.createTextStyle(hashedit.current.node),hashedit.current.node.setAttribute("style",l),e=0;e<hashedit.menu.length;e+=1)hashedit.current.node.matches(hashedit.menu[e].selector)&&hashedit.menu[e].change&&hashedit.menu[e].change(s,h,o)}-1!=r.indexOf("link.")&&(d=r.split("."),d.length>1&&(s=d[1].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),hashedit.currLink.setAttribute(s,h),hashedit.current.node.dispatchEvent(new Event("input",{bubbles:!0})))),-1!=r.indexOf("image.")&&(d=r.split("."),d.length>1&&(s=d[1].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=hashedit.current.node.getAttribute("data-ref"),hashedit.current.node.setAttribute(s,h),hashedit.setMirrorAttribute(n,s,h),null!==hashedit.current.node&&hashedit.current.node.dispatchEvent(new Event("input",{bubbles:!0}))))}},!1)})},setupTextEvents:function(){var e,t,a,i,n,r,h,s;for(t=document.querySelectorAll(".hashedit-config"),e=0;e<t.length;e+=1)["mousedown","touchstart"].forEach(function(d){t[e].addEventListener(d,function(e){if(a=e.target,"SVG"==a.nodeName&&(a=a.parentNode),a.hasAttribute("data-action")){if(i=a.getAttribute("data-action"),"hashedit.text.bold"==i)return document.execCommand("Bold",!1,null),!1;if("hashedit.text.italic"==i)return document.execCommand("Italic",!1,null),!1;if("hashedit.text.strike"==i)return document.execCommand("strikeThrough",!1,null),!1;if("hashedit.text.subscript"==i)return document.execCommand("subscript",!1,null),!1;if("hashedit.text.superscript"==i)return document.execCommand("superscript",!1,null),!1;if("hashedit.text.underline"==i)return document.execCommand("underline",!1,null),!1;if("hashedit.text.link"==i)return n=hashedit.getSelectedText(),r="<a>"+n+"</a>",document.execCommand("insertHTML",!1,r),hashedit.showLinkDialog(),!1;if("hashedit.text.image"==i)return n=hashedit.getSelectedText(),r='<img src="{{path}}images/placeholder-inline.png" class="pull-left">',r=hashedit.replaceAll(r,"{{path}}",hashedit.path),document.execCommand("insertHTML",!1,r),!1;if("hashedit.text.code"==i)return n=hashedit.getSelectedText(),r="<code>"+n+"</code>",document.execCommand("insertHTML",!1,r),!1;if("hashedit.text.alignLeft"==i)return h=document.querySelector('.hashedit-modal [data-model="node.class"]'),s=h.value,s=hashedit.replaceAll(s,"text-center",""),s=hashedit.replaceAll(s,"text-left",""),s=hashedit.replaceAll(s,"text-right",""),s+=" text-left",h.value=s.trim(),h.dispatchEvent(new Event("change",{bubbles:!0})),!1;if("hashedit.text.alignRight"==i)return h=document.querySelector('.hashedit-modal [data-model="node.class"]'),s=h.value,s=hashedit.replaceAll(s,"text-center",""),s=hashedit.replaceAll(s,"text-left",""),s=hashedit.replaceAll(s,"text-right",""),s+=" text-right",h.value=s.trim(),h.dispatchEvent(new Event("change",{bubbles:!0})),!1;if("hashedit.text.alignCenter"==i)return h=document.querySelector('.hashedit-modal [data-model="node.class"]'),s=h.value,s=hashedit.replaceAll(s,"text-center",""),s=hashedit.replaceAll(s,"text-left",""),s=hashedit.replaceAll(s,"text-right",""),s+=" text-center",h.value=s.trim(),h.dispatchEvent(new Event("change",{bubbles:!0})),!1;if("hashedit.text.undo"==i)return document.execCommand("undo",!1,null),!1}},!1)})},showLinkDialog:function(){var e,t,a,i,n,r;hashedit.currLink=hashedit.getLinkFromSelection(),null!==hashedit.currLink&&(e=hashedit.currLink.getAttribute("id")||"",t=hashedit.currLink.getAttribute("class")||"",a=hashedit.currLink.getAttribute("href")||"",i=hashedit.currLink.getAttribute("target")||"",n=hashedit.currLink.getAttribute("title")||"",r=document.querySelector("#hashedit-link-settings-modal"),r.setAttribute("visible",""),document.getElementById("hashedit-link-id").value=e,document.getElementById("hashedit-link-cssclass").value=t,document.getElementById("hashedit-link-href").value=a,document.getElementById("hashedit-link-target").value=i,document.getElementById("hashedit-link-title").value=n)},showImageDialog:function(){var e,t,a,i,n;null!==hashedit.current.node&&(e=hashedit.current.node.getAttribute("id")||"",t=hashedit.current.node.getAttribute("class")||"",a=hashedit.current.node.getAttribute("src")||"",i=hashedit.current.node.getAttribute("target")||"",n=document.querySelector("#hashedit-image-settings-modal"),n.setAttribute("visible",""),document.getElementById("hashedit-image-id").value=e,document.getElementById("hashedit-image-cssclass").value=t,document.getElementById("hashedit-image-src").value=a,document.getElementById("hashedit-image-target").value=i)},executeFunctionByName:function(e,t){var a,i,n,r;for(i=[].slice.call(arguments).splice(2),n=e.split("."),r=n.pop(),a=0;a<n.length;a++)t=t[n[a]];return t[r].apply(this,i)},getSelectedText:function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},saveSelection:function(){var e,t,a,i;if(window.getSelection){if(a=window.getSelection(),a.getRangeAt&&a.rangeCount){for(e=[],i=a.rangeCount,t=0;i>t;t+=1)e.push(a.getRangeAt(t));return e}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},getLinkFromSelection:function(){var e,t,a,i,n;return e=null,document.selection?e=document.selection.createRange().parentElement():(t=window.getSelection(),t.rangeCount>0&&(e=t.getRangeAt(0).startContainer.parentNode)),null!==e&&"A"==e.tagName?e:window.getSelection&&(t=window.getSelection(),t.rangeCount>0)?(a=t.getRangeAt(0),i=document.createElement("DIV"),i.appendChild(a.cloneContents()),n=i.getElementsByTagName("A"),n.length>0?n[0]:null):null},restoreSelection:function(e){var t,a,i;if(e)if(window.getSelection)for(i=window.getSelection(),i.removeAllRanges(),a=e.length,t=0;a>t;t+=1)i.addRange(e[t]);else document.selection&&e.select&&e.select()},createTextStyle:function(e){var t,a,i,n,r,h,s;return t="",a=e.getAttribute("text-color")||"",i=e.getAttribute("text-size")||"",n=e.getAttribute("text-shadow-color")||"",r=e.getAttribute("text-shadow-horizontal")||"",h=e.getAttribute("text-shadow-horizontal")||"",s=e.getAttribute("text-shadow-blur")||"",""!==a&&(t+="color:"+a+";"),""!==i&&(t+="font-size:"+i+";"),""!==n&&(t+="text-shadow: "+r+" "+h+" "+s+" "+n+";"),t},getQueryStringByName:function(e){var t,a,i;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t="[\\?&]"+e+"=([^&#]*)",a=new RegExp(t),i=a.exec(window.location.href),null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},retrieveHTML:function(){return hashedit.mirror.documentElement.outerHTML},retrieveUpdateArray:function(){var e,t,a,i,n;for(a=hashedit.mirror.documentElement.querySelectorAll("[hashedit]"),t=[],e=0;e<a.length;e+=1)n=a[e].querySelectorAll("[data-ref]"),i={selector:a[e].getAttribute("hashedit-selector"),html:a[e].innerHTML},t.push(i);return{url:hashedit.url,changes:t}},createMirror:function(){var e;fetch("/mirror?q="+hashedit.url).then(function(e){return e.text()}).then(function(t){e=new DOMParser,hashedit.mirror=e.parseFromString(t,"text/html")})},removeMirrorElement:function(e){var t;t=hashedit.mirror.querySelector('[data-ref="'+e+'"]'),t.remove()},setMirrorHTML:function(e,t){var a;a=hashedit.mirror.querySelector('[data-ref="'+e+'"]'),a.innerHTML=t},setMirrorAttribute:function(e,t,a){var i;i=hashedit.mirror.querySelector('[data-ref="'+e+'"]'),i.setAttribute(t,a)},moveMirrorElement:function(e,t,a){console.log("ref="+e+" toRef="+t+" method="+a);var i,n,r;hashedit.debug===!0&&console.log("[hashedit.moveMirrorElement] ref="+e+" toref="+t+" method="+a),i=hashedit.mirror.querySelector('[data-ref="'+e+'"]'),n=hashedit.mirror.querySelector('[data-ref="'+t+'"]'),null!==n&&(r=n.parentNode,"before"==a?r.insertBefore(i,n):"append"==a&&n.appendChild(i))},insertMirrorElement:function(e,t,a,i){var n,r,h,s;hashedit.debug===!0&&console.log("[hashedit.insertMirrorElement] ref="+e+" toref="+t+" method="+a),n=hashedit.mirror.createElement("div"),n.innerHTML=i,r=n.firstChild,r.setAttribute("data-ref",e),h=hashedit.mirror.querySelector('[data-ref="'+t+'"]'),s=h.parentNode,"before"==a?s.insertBefore(r,h):"append"==a&&h.appendChild(r)},setup:function(){var e,t,a,i,n,r,h,s;e=document.querySelector("body"),s="/login",a="/node_modules/hashedit/",i=["/node_modules/hashedit/dist/hashedit-min.css"],n=[".sortable"],r=!1,h=null,null!=e&&(1==e.hasAttribute("hashedit-dev")&&(a="/dev/hashedit/",i=["/dev/hashedit/css/hashedit.css"]),1==e.hasAttribute("hashedit-demo")&&(r=!0),1==e.hasAttribute("hashedit-sortable")&&(t=e.getAttribute("hashedit-sortable"),
""!=t&&(n=t.split(",")),e.removeAttribute("hashedit-sortable")),1==e.hasAttribute("hashedit-url")&&(h=e.getAttribute("hashedit-url")),1==e.hasAttribute("hashedit-login")&&(s=e.getAttribute("hashedit-login")),1==e.hasAttribute("hashedit-auth")&&"token"==e.getAttribute("hashedit-auth")&&(hashedit.useToken=!0,hashedit.authHeader="Authorization",hashedit.authHeaderPrefix="Bearer",hashedit.tokenName="id_token",1==e.hasAttribute("hashedit-auth-header")&&(hashedit.authHeader=e.getAttribute("hashedit-auth-header")),1==e.hasAttribute("hashedit-auth-header-prefix")&&(hashedit.authHeader=e.getAttribute("hashedit-auth-header-prefix")),1==e.hasAttribute("hashedit-auth-token")&&(hashedit.tokenName=e.getAttribute("hashedit-auth-token"))));var d={path:a,login:s,stylesheet:i,sortable:n,demo:r};null!=h&&(d.url=h),hashedit.setupEditor(d)},setupEditor:function(e){var t,a;for(console.log("Hashedit version: "+hashedit.version),null!=e.path&&(hashedit.path=e.path),null!=e.login&&(hashedit.loginUrl=e.login),hashedit.current.container=document.createElement("div"),hashedit.current.container.setAttribute("class","hashedit-container"),hashedit.current.container.setAttribute("id","hashedit-container"),null!==e.stylesheet&&(hashedit.stylesheet=e.stylesheet),null!==e.url&&(hashedit.url=e.url),document.body.appendChild(hashedit.current.container),a=document.createElement("style"),t=0;t<hashedit.stylesheet.length;t++)a.innerHTML+="@import url("+hashedit.stylesheet[t]+");";if(hashedit.current.container.appendChild(a),e.demo===!0)hashedit.demo=!0,hashedit.createMirror(),hashedit.setActive(),hashedit.setupSortable(e.sortable),hashedit.setContentEditable(),hashedit.setupContentEditableEvents(),hashedit.setupMenu(e.path),hashedit.setupToast(),hashedit.createMenu(e.path),hashedit.loadHTML(e.path);else{var i={credentials:"include"};hashedit.useToken&&(i={headers:{}},i.headers[hashedit.authHeader]=hashedit.authHeaderPrefix+" "+localStorage.getItem(hashedit.tokenName)),fetch(hashedit.authUrl,i).then(function(t){if(200!==t.status)hashedit.showAuth();else{hashedit.createMirror(),hashedit.setActive(),hashedit.setupSortable(e.sortable),hashedit.setContentEditable(),hashedit.setupContentEditableEvents(),hashedit.setupMenu(e.path),hashedit.setupToast(),hashedit.createMenu(e.path),hashedit.loadHTML(e.path);var a=new Event("hashedit.loaded");document.dispatchEvent(a)}})}},wrap:function(e,t){var a,i,n,r,h;for(t.length||(t=[t]),a=t.length-1;a>=0;a--)i=a>0?e.cloneNode(!0):e,n=t[a],r=n.parentNode,h=n.nextSibling,i.appendChild(n),h?r.insertBefore(i,h):r.appendChild(i)},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},showAuth:function(){window.location=hashedit.loginUrl},setupToast:function(){var e;e=document.createElement("div"),e.setAttribute("class","hashedit-toast"),e.innerHTML="Sample Toast",hashedit.current?hashedit.current.container.appendChild(e):document.body.appendChild(e)},replaceAll:function(e,t,a){var i,n;for(i=e,n=i.indexOf(t);-1!=n;)i=i.replace(t,a),n=i.indexOf(t);return i},showToast:function(e,t){var a;a=document.querySelector(".hashedit-toast"),a.innerHTML=e,a.removeAttribute("success"),a.removeAttribute("failure"),a.setAttribute("active",""),"success"==t?a.setAttribute("success",""):"failure"==t&&a.setAttribute("failure",""),setTimeout(function(){a.removeAttribute("active")},2e3)},findParentBySelector:function(e,t){var a,i;for(a=document.querySelectorAll(t),i=e.parentNode;i&&!hashedit.collectionHas(a,i);)i=i.parentNode;return i},collectionHas:function(e,t){var a,i;for(i=e.length,a=0;i>a;a+=1)if(e[a]==t)return!0;return!1}}}();